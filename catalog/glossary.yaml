glossary:
  entries:
    # --- PnL variants ---

    - name: total PnL
      definition: >-
        Sum of instant_pnl across all trades. Measures gross profitability before
        fees. Formula: SUM(instant_pnl). Use instant_pnl_w_fees for net PnL.
      synonyms:
        - total profit
        - aggregate pnl
        - gross pnl
        - P&L
      related_columns:
        - markettrade.instant_pnl
        - quotertrade.instant_pnl
        - brokertrade.instant_pnl
        - clicktrade.instant_pnl
        - otoswing.instant_pnl
      category: performance
      sql_pattern: "SUM(instant_pnl)"

    - name: net PnL
      definition: >-
        Sum of instant_pnl_w_fees across all trades. Measures true profitability
        after exchange fees and clearing costs. Formula: SUM(instant_pnl_w_fees).
        This is instant_pnl minus fees.
      synonyms:
        - pnl after fees
        - pnl with fees
        - net profit
        - true pnl
      related_columns:
        - markettrade.instant_pnl_w_fees
        - markettrade.fees
        - markettrade.instant_pnl
      category: performance
      sql_pattern: "SUM(instant_pnl_w_fees)"

    - name: mark-to-mid PnL
      definition: >-
        PnL computed by marking the trade to mid-market theoretical value rather
        than the execution reference TV. Stored as mark_to_mid_pnl (before fees)
        and mark_to_mid_pnl_w_fees (after fees). Alternative P&L perspective.
      synonyms:
        - mid pnl
        - mark to mid
        - mtm pnl
      related_columns:
        - markettrade.mark_to_mid_pnl
        - markettrade.mark_to_mid_pnl_w_fees
      category: performance

    - name: PnL disambiguation
      definition: >-
        When a trader asks for "PnL" without qualification, default to
        instant_pnl (gross, before fees). If they say "net PnL" or "after fees",
        use instant_pnl_w_fees. If they say "mark to mid", use mark_to_mid_pnl.
        Never mix PnL variants in a single aggregation.
      synonyms:
        - pnl rules
        - which pnl
        - pnl column selection
      related_columns:
        - markettrade.instant_pnl
        - markettrade.instant_pnl_w_fees
        - markettrade.mark_to_mid_pnl
      category: disambiguation

    # --- Edge metrics ---

    - name: edge
      definition: >-
        Instantaneous edge per unit (in ticks) at trade execution. The column is
        instant_edge. Measures the difference between execution price and fair
        value (tv). Positive = traded better than fair value. This is the most
        commonly queried KPI metric on the trading desk.
      synonyms:
        - trading edge
        - capture
        - theoretical edge
        - instant edge
      related_columns:
        - markettrade.instant_edge
        - markettrade.tv
        - markettrade.trade_price
      category: performance
      sql_pattern: "AVG(instant_edge)"

    - name: good fill
      definition: >-
        A trade where the edge captured is positive, meaning the execution price
        was better than fair value. Typically defined as instant_edge > 0 or
        edge_ticks > 0 depending on context. Used to measure execution quality.
      synonyms:
        - positive edge
        - good execution
        - favorable fill
      related_columns:
        - markettrade.instant_edge
      category: performance
      sql_pattern: "instant_edge > 0"

    # --- Slippage decomposition ---

    - name: slippage
      definition: >-
        Time-bucketed PnL decomposition measuring how trade value changes after
        execution. Decomposed into delta_slippage (underlying price movement),
        vol_slippage (volatility changes), roll_slippage (carry/dividend changes),
        and other_slippage (residual including gamma). Total slippage =
        delta + vol + roll + other. Each component is available at 9 standard
        intraday intervals plus EOD and multiday.
      synonyms:
        - price slippage
        - execution slippage
        - slippage decomposition
        - total slippage
      related_columns:
        - markettrade.delta_slippage_1s
        - markettrade.vol_slippage_1s
        - markettrade.roll_slippage_1s
        - markettrade.other_slippage_1s
        - markettrade.total_slippage_1s
      category: performance

    - name: slippage intervals
      definition: >-
        Slippage columns follow the naming pattern {family}_{interval}. The 9
        standard intraday intervals are 1s, 5s, 10s, 30s, 1m, 5m, 10m, 30m, 1h.
        EOD uses the suffix eod. Multiday uses 1D and 5D. Example:
        delta_slippage_5m, vol_slippage_1h, total_slippage_1D. Per-unit variants
        append _per_unit (e.g. delta_slippage_5m_per_unit).
      synonyms:
        - interval naming
        - slippage time buckets
        - slippage intervals
      related_columns:
        - markettrade.delta_slippage_1s
        - markettrade.delta_slippage_5m
        - markettrade.delta_slippage_1h
        - markettrade.delta_slippage_1D
      category: naming_convention

    # --- Trade type taxonomy ---

    - name: trade type taxonomy
      definition: >-
        markettrade is the superset of ALL market trades from all participants.
        quotertrade, brokertrade, clicktrade, and otoswing are Mako-specific
        subsets. CRITICAL: never SUM markettrade with any of the four Mako tables
        â€” that double-counts. For all trades use markettrade alone. For Mako-only
        totals, UNION ALL the four Mako tables.
      synonyms:
        - table selection
        - trade tables
        - which table
        - double counting
      related_columns:
        - markettrade.trade_type
      category: disambiguation

    - name: combo trade
      definition: >-
        A multi-leg trade (e.g. straddle, strangle, calendar spread). When
        is_parent=TRUE, the row contains aggregated combo-level KPIs summed
        across all legs. When is_parent=FALSE, each row is a single leg.
        Default to is_parent=TRUE unless the trader specifically wants leg-level
        detail. The parent_combo_type_name column describes the combo type.
      synonyms:
        - spread
        - multi-leg
        - straddle
        - strangle
        - combo
      related_columns:
        - markettrade.is_parent
        - markettrade.parent_is_combo
        - markettrade.no_legs
        - markettrade.parent_combo_type_name
      category: trade_structure

    # --- Timestamp conventions ---

    - name: trade date filtering
      definition: >-
        All KPI and data tables are partitioned on trade_date (DATE). Every query
        MUST include a WHERE trade_date filter for performance. If the user
        doesn't specify a date, default to CURRENT_DATE(). For "today's trades"
        use WHERE trade_date = CURRENT_DATE(). For date ranges use BETWEEN.
      synonyms:
        - today
        - date filter
        - partition filter
        - current date
      related_columns:
        - markettrade.trade_date
      category: query_pattern
      sql_pattern: "WHERE trade_date = CURRENT_DATE()"

    - name: event timestamp
      definition: >-
        Nanosecond-precision timestamp of trade execution, stored as
        event_timestamp_ns (INT64). This is the primary timestamp for time-range
        filtering within a day. Use trade_date for date-level filtering and
        event_timestamp_ns for intraday precision.
      synonyms:
        - execution time
        - trade time
        - timestamp
        - nano timestamp
      related_columns:
        - markettrade.event_timestamp_ns
      category: naming_convention

    # --- KPI vs data distinction ---

    - name: KPI vs data dataset
      definition: >-
        The KPI dataset contains performance metrics (instant_edge, instant_pnl,
        slippage decomposition, Greeks). The data dataset contains raw execution
        details (timestamps, prices, sizes, fills, market depth). If the question
        is about performance, edge, PnL, or slippage, use KPI tables. If the
        question is about raw execution details, timestamps, or fill information,
        use data tables.
      synonyms:
        - which dataset
        - dataset selection
        - kpi or data
      related_columns:
        - markettrade.instant_edge
        - markettrade.instant_pnl
      category: disambiguation

    # --- Greeks and pricing ---

    - name: delta
      definition: >-
        Option delta: directional exposure to the underlying asset. Stored in the
        delta column. Values range from 0 to 1 for calls, -1 to 0 for puts.
        ATM options have delta ~ 0.5. Delta is captured at trade time and
        re-snapshotted at each interval (delta_1s, delta_5m, etc.). Used in
        slippage decomposition and hedging analysis.
      synonyms:
        - directional exposure
        - hedge ratio
        - option delta
      related_columns:
        - markettrade.delta
        - markettrade.delta_1s
        - markettrade.delta_5m
      category: greeks

    - name: implied volatility
      definition: >-
        Implied volatility (IV) at trade time, stored in the vol column.
        Represents the market's expectation of future price movement embedded in
        the option price. Different from realized/historical volatility.
        Vol changes drive vol_slippage at each interval.
      synonyms:
        - implied vol
        - IV
        - volatility
        - vol
      related_columns:
        - markettrade.vol
        - markettrade.vol_slippage_1s
      category: greeks

    - name: ATM strike
      definition: >-
        At-the-money strike: the strike price closest to the current underlying
        price, where delta is approximately 0.5 for calls or -0.5 for puts.
        Filter with ABS(delta) BETWEEN 0.45 AND 0.55 for near-ATM trades.
        The strike column holds the strike price; compare with the underlying
        price via the symbol column.
      synonyms:
        - at the money
        - ATM
        - near the money
      related_columns:
        - markettrade.strike
        - markettrade.delta
        - markettrade.symbol
      category: greeks
      sql_pattern: "ABS(delta) BETWEEN 0.45 AND 0.55"

    # --- Exchange concepts ---

    - name: exchange
      definition: >-
        The exchange where the trade was executed. Stored in the exchange column
        (STRING). Common values include ICE, Eurex, NSE, OMX, KRX, CME, CBOE.
        Each exchange has different session times, tick sizes, and contract
        specifications. Filter by exchange to analyze venue-specific performance.
      synonyms:
        - venue
        - exchange code
        - trading venue
      related_columns:
        - markettrade.exchange
      category: dimension

    # --- Named filter patterns ---

    - name: calls only
      definition: >-
        Filter for call options only. Use WHERE option_type_name = 'CALL' or
        option_type = 'C'. The option_type_name column is human-readable.
      synonyms:
        - call options
        - calls
        - call filter
      related_columns:
        - markettrade.option_type_name
        - markettrade.option_type
      category: query_pattern
      sql_pattern: "option_type_name = 'CALL'"

    - name: puts only
      definition: >-
        Filter for put options only. Use WHERE option_type_name = 'PUT' or
        option_type = 'P'. The option_type_name column is human-readable.
      synonyms:
        - put options
        - puts
        - put filter
      related_columns:
        - markettrade.option_type_name
        - markettrade.option_type
      category: query_pattern
      sql_pattern: "option_type_name = 'PUT'"

    - name: today only
      definition: >-
        Filter for today's trades only. Use WHERE trade_date = CURRENT_DATE().
        This is the default when the user says "today" or doesn't specify a date.
      synonyms:
        - today's trades
        - current day
        - intraday
      related_columns:
        - markettrade.trade_date
      category: query_pattern
      sql_pattern: "trade_date = CURRENT_DATE()"

    - name: buy side
      definition: >-
        Filter for buy trades. The buysell column stores numeric codes:
        BUY = 66, SELL = 83. Use WHERE buysell = 66 for buys or
        buysell_name = 'BUY'. The buysell_name column is the human-readable form.
      synonyms:
        - buys
        - long
        - buy trades
        - bought
      related_columns:
        - markettrade.buysell
        - markettrade.buysell_name
      category: query_pattern
      sql_pattern: "buysell = 66"

    - name: sell side
      definition: >-
        Filter for sell trades. The buysell column stores numeric codes:
        BUY = 66, SELL = 83. Use WHERE buysell = 83 for sells or
        buysell_name = 'SELL'. The buysell_name column is the human-readable form.
      synonyms:
        - sells
        - short
        - sell trades
        - sold
      related_columns:
        - markettrade.buysell
        - markettrade.buysell_name
      category: query_pattern
      sql_pattern: "buysell = 83"

    # --- OTO swing specific ---

    - name: OTO swing
      definition: >-
        OTO (One-Touch-Out) swing trades are automated takeout trades that fire
        when market conditions cross edge thresholds. Stored in the otoswing
        table. Key unique columns: min_edge (minimum required edge threshold),
        swing_edge (edge captured), takeout_category and takeout_type (trigger
        classification). Use the otoswing table, not markettrade, to analyze
        swing-specific metrics.
      synonyms:
        - swing
        - takeout
        - OTO
        - sweep
        - automated trade
      related_columns:
        - otoswing.swing_edge
        - otoswing.min_edge
        - otoswing.takeout_category
        - otoswing.takeout_type
      category: trade_structure

    # --- Portfolio and algo ---

    - name: portfolio
      definition: >-
        Trading portfolio or desk identifier. Stored in the portfolio column
        (STRING). Common values: MON, WHITE, RED, BROADWAY, FIXEDINCOME_US,
        US_D1_OPT, AMM_OIL, FIPROP_US, EURODOLLARS, STOCKS_EUR, INDEXPROP,
        EUPOWER. Use to segment performance by trading desk.
      synonyms:
        - book
        - desk
        - trading book
        - portfolio name
      related_columns:
        - markettrade.portfolio
      category: dimension

    - name: algorithm
      definition: >-
        Trading algorithm or strategy name. Stored in the algo column (STRING).
        Common values: OST_MQ (auto-quoter), OST_X (Korea market maker),
        ZB_TAK (taker strategy). Use to segment performance by execution
        strategy.
      synonyms:
        - algo
        - strategy
        - algo name
        - trading strategy
        - execution algo
      related_columns:
        - markettrade.algo
      category: dimension

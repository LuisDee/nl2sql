table:
  name: posdata
  dataset: "{dataset_prefix}eurex_data"
  fqn: '{project}.{dataset_prefix}eurex_data.posdata'
  layer: data
  description: "Position data snapshots from the PositionEvent proto (PosData.proto). Contains position state records including instrument, portfolio, size, price, and settlement details. The tradedata and clicktrade tables are derived subsets of this data. Partitioned by trade_date."
  partition_field: trade_date
  columns:
    - name: kafka_partition
      type: INTEGER
      description: Kafka partition number from which this record was consumed. Used internally for data pipeline
        tracking and replay.
      category: identifier
      filterable: true
    - name: kafka_offset
      type: INTEGER
      description: Kafka offset of the record within its partition. Used for exactly-once processing guarantees and data
        pipeline replay.
      category: identifier
      filterable: true
    - name: symbol
      type: STRING
      description: Mako symbol identifier for the traded instrument.
      category: dimension
      filterable: true
    - name: portfolio
      type: STRING
      description: Name of the Mako portfolio to which the algo belongs.
      category: dimension
      filterable: true
    - name: trade_date
      type: DATE
      description: Trading session date used as the partition column. Always filter on this field for efficient queries.
      category: time
      filterable: true
    - name: mako_id
      type: STRING
      description: Mako-internal unique identifier for this trade or order.
      category: identifier
      filterable: true
    - name: trader_id
      type: STRING
      description: Identifier of the trader responsible for this trade.
      category: identifier
      filterable: true
    - name: algorithm
      type: STRING
      description: Name of the Mako algorithm that generated this trade or event.
      category: dimension
      filterable: true
    - name: routed_exchange
      type: INTEGER
      description: Exchange to which this order was routed for execution.
      category: measure
      typical_aggregation: AVG
    - name: executable_exchange
      type: INTEGER
      description: Exchange on which this instrument is executable.
      category: measure
      typical_aggregation: AVG
    - name: channel
      type: STRING
      description: Data channel or feed identifier for this event.
      category: dimension
      filterable: true
    - name: transaction_properties
      type: INTEGER
      description: A mask of TransactionProperty.
      category: measure
      typical_aggregation: AVG
    - name: tag_book
      type: INTEGER
      description: A mask of TransactionTag.
      category: measure
      typical_aggregation: AVG
    - name: tag_exchange
      type: INTEGER
      description: A mask of TransactionTagExchange.
      category: measure
      typical_aggregation: AVG
    - name: tag_user
      type: INTEGER
      description: A mask of TransactionTagUser.
      category: measure
      typical_aggregation: AVG
    - name: revision
      type: INTEGER
      description: Revision number tracking modifications to this record.
      category: identifier
      filterable: true
    - name: inventory
      type: STRING
      description: Inventory account associated with this trade or position.
      category: dimension
      filterable: true
    - name: account
      type: STRING
      description: Account identifier for this trade.
      category: dimension
      filterable: true
    - name: fill_id
      type: INTEGER
      description: Unique identifier for this fill (partial or full execution) within an order.
      category: identifier
      filterable: true
    - name: user_id
      type: INTEGER
      description: Algo-internal id.
      category: identifier
      filterable: true
    - name: user_order_id
      type: INTEGER
      description: User-submitted order identifier linking back to the order entry system.
      category: identifier
      filterable: true
    - name: transaction_id
      type: INTEGER
      description: Mako-internal transaction identifier for this event.
      category: identifier
      filterable: true
    - name: order_id
      type: INTEGER
      description: Mako-internal order identifier linking fills to the parent order.
      category: identifier
      filterable: true
    - name: exchange_transaction_id
      type: STRING
      description: Exchange-assigned transaction identifier for this event.
      category: identifier
      filterable: true
    - name: exchange_order_id
      type: STRING
      description: Exchange-assigned order identifier.
      category: identifier
      filterable: true
    - name: transaction_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the transaction occurred.
      category: time
    - name: transaction_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the transaction timestamp. Combine with transaction_timestamp for
        full nanosecond-resolution timing.
      category: time
    - name: exchange_date
      type: DATE
      description: Date as reported by the exchange for this event.
      category: time
      filterable: true
    - name: exchange_timestamp
      type: TIMESTAMP
      description: Exchange-provided nano-second timestamp of the event.
      category: time
    - name: exchange_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of exchange timestamp. Exchange-provided nano-second timestamp of the
        event.
      category: time
    - name: exchange_info
      type: STRING
      description: Additional exchange-provided information for this event.
      category: dimension
      filterable: true
    - name: exchange_info_bits
      type: INTEGER
      description: A mask of TransactionExchangeInfo.
      category: measure
      typical_aggregation: AVG
    - name: exchange_qualifier
      type: STRING
      description: Exchange qualifier code providing additional event context.
      category: dimension
      filterable: true
    - name: statistics
      type: STRING
      description: Statistical summary or classification data for this event.
      category: dimension
      filterable: true
    - name: position_type
      type: INTEGER
      description: Numeric code classifying the position event type (e.g. trade, adjustment, exercise).
      category: dimension
      filterable: true
    - name: position_id
      type: INTEGER
      description: Identifier for the position this event belongs to within the portfolio.
      category: identifier
      filterable: true
    - name: size
      type: INTEGER
      description: Number of lots or contracts in the trade or order.
      category: measure
      typical_aggregation: AVG
    - name: tv
      type: FLOAT
      description: Theoretical value the VT saw at time of swing/market trade.
      category: measure
      typical_aggregation: AVG
    - name: ectv
      type: FLOAT
      description: Exchange-cleared theoretical value used for settlement calculations.
      category: measure
      typical_aggregation: AVG
    - name: settlement
      type: FLOAT
      description: Settlement price for the instrument.
      category: measure
      typical_aggregation: AVG
    - name: settlement_date
      type: DATE
      description: Date on which settlement occurs for this trade.
      category: time
    - name: pos_currency
      type: INTEGER
      description: Enum appears as an int in composition.
      category: measure
      typical_aggregation: AVG
    - name: pos_value_currency
      type: INTEGER
      description: Currency in which the position value is denominated.
      category: measure
      typical_aggregation: AVG
    - name: cash_value
      type: FLOAT
      description: Cash value of this trade or position change.
      category: measure
      typical_aggregation: AVG
    - name: mgmt_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the mgmt occurred.
      category: time
    - name: mgmt_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the mgmt timestamp. Combine with mgmt_timestamp for full
        nanosecond-resolution timing.
      category: time
    - name: max_trade_id
      type: INTEGER
      description: Maximum trade ID in the batch, used for ordering and deduplication.
      category: identifier
      filterable: true
    - name: agg_pos_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the agg pos occurred.
      category: time
    - name: agg_pos_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the agg pos timestamp. Combine with agg_pos_timestamp for full
        nanosecond-resolution timing.
      category: time
    - name: agg_pos_date
      type: DATE
      description: Aggregated position date for end-of-day processing.
      category: time
    - name: price
      type: FLOAT
      description: Price of the trade or order.
      category: measure
      typical_aggregation: AVG
    - name: deflection_scale
      type: FLOAT
      description: Scale factor for the deflection adjustment applied to pricing.
      category: measure
      typical_aggregation: AVG
    - name: curve_id
      type: INTEGER
      description: Identifier for the volatility/pricing curve used in theoretical calculations.
      category: identifier
      filterable: true
    - name: carry_id
      type: INTEGER
      description: Identifier for the carry/interest rate curve used in theoretical calculations.
      category: identifier
      filterable: true
    - name: revision_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the revision occurred.
      category: time
    - name: revision_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the revision timestamp. Combine with revision_timestamp for full
        nanosecond-resolution timing.
      category: time
    - name: trade_id
      type: INTEGER
      description: Exchange-assigned trade identifier.
      category: identifier
      filterable: true
    - name: company_position
      type: INTEGER
      description: Net company-wide position for this instrument after this event.
      category: measure
      typical_aggregation: AVG
    - name: traded_size
      type: INTEGER
      description: Number of lots traded in this transaction.
      category: measure
      typical_aggregation: SUM
    - name: message_trade_date
      type: DATE
      description: Trade date embedded within the original proto message.
      category: time
    - name: value_date
      type: DATE
      description: Value date for the trade, relevant for settlement calculations.
      category: time
    - name: counterparty
      type: STRING
      description: Counterparty identifier for this trade.
      category: dimension
      filterable: true
    - name: text
      type: STRING
      description: Free-text field containing additional descriptive information about this event.
      category: dimension
      filterable: true
    - name: revisor
      type: STRING
      description: Identifier of the user or process that last revised this record.
      category: dimension
      filterable: true
    - name: instrument_hash
      type: STRING
      description: Unique SHA256 hash identifier for the instrument, deterministically computed from the instrument
        defining attributes. Used as the primary join key across all data and KPI tables.
      category: identifier
      filterable: true
    - name: strike
      type: FLOAT
      description: Strike price for options, enriched from the instruments reference table. NULL for non-option
        instruments.
      category: measure
      typical_aggregation: AVG
    - name: option_type
      type: INTEGER
      description: Option type code (C=Call, P=Put), enriched from the instruments reference table. NULL for non-option
        instruments.
      category: dimension
      filterable: true
    - name: option_type_name
      type: STRING
      description: Human-readable option type name (Call/Put), enriched from the instruments reference table.
      category: dimension
      filterable: true
    - name: expiry_timestamp
      type: TIMESTAMP
      description: Expiry timestamp for the instrument, enriched from the instruments reference table.
      category: time
    - name: mako_symbol
      type: STRING
      description: Mako-internal symbol identifier, enriched from the instruments reference table via instrument_hash
        join.
      category: dimension
      filterable: true
    - name: currency
      type: INTEGER
      description: Enum appears as an int in composition.
      category: dimension
      filterable: true
    - name: term
      type: STRING
      description: Expiry term/maturity label for the instrument, enriched from the instruments reference table.
      category: dimension
      filterable: true
    - name: inst_type_name
      type: STRING
      description: Human-readable instrument type name (e.g. option, future, stock), enriched from the instruments
        reference table.
      category: dimension
      filterable: true
    - name: streamsource_stream_id
      type: INTEGER
      description: Stream source stream id identifier from the data streaming infrastructure.
      category: identifier
      filterable: true
    - name: streamsource_event_id
      type: INTEGER
      description: Stream source event id identifier from the data streaming infrastructure.
      category: identifier
      filterable: true
    - name: streamsource_message_id
      type: INTEGER
      description: Stream source message id identifier from the data streaming infrastructure.
      category: identifier
      filterable: true
    - name: datasource_pid
      type: INTEGER
      description: Data source pid identifier from the data pipeline infrastructure.
      category: measure
      typical_aggregation: AVG
    - name: datasource_hostname
      type: STRING
      description: Data source hostname identifier from the data pipeline infrastructure.
      category: dimension
      filterable: true

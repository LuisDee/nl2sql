table:
  name: tradedata
  dataset: "{dataset_prefix}nse_data"
  fqn: '{project}.{dataset_prefix}nse_data.tradedata'
  layer: data
  description: "Raw trade execution data from the PositionEvent proto (PosData.proto). Contains all position and trade events including algorithm name, position type, and transaction details. This is the superset table from which the clicktrade KPI table is derived by filtering on algorithm and position type. Partitioned by trade_date."
  partition_field: trade_date
  columns:
    - name: kafka_partition
      type: INTEGER
      description: Kafka partition number from which this record was consumed. Used internally for data pipeline
        tracking and replay.
      category: identifier
      filterable: true
      source: kafka infrastructure
    - name: kafka_offset
      type: INTEGER
      description: Kafka offset of the record within its partition. Used for exactly-once processing guarantees and data
        pipeline replay.
      category: identifier
      filterable: true
      source: kafka infrastructure
    - name: symbol
      type: STRING
      description: Mako symbol identifier for the traded instrument.
      category: dimension
      filterable: true
      source: kafka infrastructure
      synonyms: ["ticker", "product", "instrument", "underlying symbol"]
    - name: portfolio
      type: STRING
      description: Name of the Mako portfolio to which the trading algorithm belongs.
      category: dimension
      filterable: true
      source: kafka infrastructure
      synonyms: ["book", "trading book"]
    - name: trade_date
      type: DATE
      description: Trading session date used as the partition column. Always filter on this field for efficient queries.
      category: time
      filterable: true
      source: kafka infrastructure
      synonyms: ["date", "business date", "trading date"]
    - name: mako_id
      type: STRING
      description: Mako-internal unique identifier for this trade or order.
      category: identifier
      filterable: true
      source: PositionEvent.makoId (data/PosData.proto)
      synonyms: ["mako identifier"]
    - name: trader_id
      type: STRING
      description: Identifier of the trader responsible for this trade.
      category: identifier
      filterable: true
      source: PositionEvent.traderId (data/PosData.proto)
      synonyms: ["trader", "user id", "trader name"]
    - name: algorithm
      type: STRING
      description: Name of the Mako algorithm that generated this trade or event.
      category: dimension
      filterable: true
      source: kafka infrastructure
      synonyms: ["strategy", "algo name", "trading algo"]
    - name: routed_exchange
      type: INTEGER
      description: Exchange to which this order was routed for execution.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.routedExchange (data/PosData.proto)
    - name: executable_exchange
      type: INTEGER
      description: Exchange on which this instrument is executable.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.executableExchange (data/PosData.proto)
      synonyms: ["execution exchange", "fill exchange"]
    - name: channel
      type: STRING
      description: Data channel or feed identifier for this event.
      category: dimension
      filterable: true
      source: kafka infrastructure
      synonyms: ["execution channel", "trading channel"]
    - name: transaction_properties
      type: INTEGER
      description: A mask of TransactionProperty. From PositionEvent proto.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.transactionProperties (data/PosData.proto)
    - name: tag_book
      type: INTEGER
      description: A mask of TransactionTag. From PositionEvent proto.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.tagBook (data/PosData.proto)
    - name: tag_exchange
      type: INTEGER
      description: A mask of TransactionTagExchange. From PositionEvent proto.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.tagExchange (data/PosData.proto)
    - name: tag_user
      type: INTEGER
      description: A mask of TransactionTagUser. From PositionEvent proto.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.tagUser (data/PosData.proto)
    - name: revision
      type: INTEGER
      description: Revision number tracking modifications to this record.
      category: identifier
      filterable: true
      source: kafka infrastructure
      synonyms: ["version", "amendment number"]
    - name: inventory
      type: STRING
      description: Inventory account associated with this trade or position.
      category: dimension
      filterable: true
      source: kafka infrastructure
      synonyms: ["sub-account", "inventory account"]
    - name: account
      type: STRING
      description: Account identifier for this trade.
      category: dimension
      filterable: true
      source: kafka infrastructure
      synonyms: ["trading account", "broker account", "clearing account"]
    - name: fill_id
      type: INTEGER
      description: Unique identifier for this fill (partial or full execution) within an order.
      category: identifier
      filterable: true
      source: PositionEvent.fillId (data/PosData.proto)
    - name: user_id
      type: INTEGER
      description: Algo-internal id. From PositionEvent proto.
      category: identifier
      filterable: true
      source: PositionEvent.userId (data/PosData.proto)
    - name: user_order_id
      type: INTEGER
      description: User-submitted order identifier linking back to the order entry system.
      category: identifier
      filterable: true
      source: PositionEvent.userOrderId (data/PosData.proto)
    - name: transaction_id
      type: INTEGER
      description: Mako-internal transaction identifier for this event.
      category: identifier
      filterable: true
      source: PositionEvent.transactionId (data/PosData.proto)
      synonyms: ["trade id"]
    - name: order_id
      type: INTEGER
      description: Mako-internal order identifier linking fills to the parent order.
      category: identifier
      filterable: true
      source: PositionEvent.orderId (data/PosData.proto)
      synonyms: ["mako order id"]
    - name: exchange_transaction_id
      type: STRING
      description: Exchange-assigned transaction identifier for this event.
      category: identifier
      filterable: true
      source: PositionEvent.exchangeTransactionId (data/PosData.proto)
      synonyms: ["exchange trade id"]
    - name: exchange_order_id
      type: STRING
      description: Exchange-assigned order identifier.
      category: identifier
      filterable: true
      source: PositionEvent.exchangeOrderId (data/PosData.proto)
      synonyms: ["exchange order"]
    - name: transaction_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the transaction occurred.
      category: time
      source: PositionEvent.transactionTimestamp (data/PosData.proto)
      synonyms: ["transaction time", "booking time"]
    - name: transaction_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the transaction timestamp. Combine with transaction_timestamp for
        full nanosecond-resolution timing.
      category: time
      source: PositionEvent.transactionTimestamp_ns (data/PosData.proto)
    - name: exchange_date
      type: DATE
      description: Date as reported by the exchange for this event.
      category: time
      filterable: true
      source: derived (data-loader)
      synonyms: ["exchange trading date"]
    - name: exchange_timestamp
      type: TIMESTAMP
      description: Exchange-provided nano-second timestamp of the event. From PositionEvent proto.
      category: time
      source: PositionEvent.exchangeTimestamp (data/PosData.proto)
      synonyms: ["exchange time", "matching engine time"]
    - name: exchange_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of exchange timestamp. Exchange-provided nano-second timestamp of the
        event. From PositionEvent proto.
      category: time
      source: PositionEvent.exchangeTimestamp_ns (data/PosData.proto)
      synonyms: ["exchange time ns"]
    - name: exchange_info
      type: STRING
      description: Additional exchange-provided information for this event.
      category: dimension
      filterable: true
      source: PositionEvent.exchangeInfo (data/PosData.proto)
    - name: exchange_info_bits
      type: INTEGER
      description: A mask of TransactionExchangeInfo. From PositionEvent proto.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.exchangeInfoBits (data/PosData.proto)
    - name: exchange_qualifier
      type: STRING
      description: Exchange qualifier code providing additional event context.
      category: dimension
      filterable: true
      source: PositionEvent.exchangeQualifier (data/PosData.proto)
    - name: statistics
      type: STRING
      description: Statistical summary or classification data for this event.
      category: dimension
      filterable: true
      source: kafka infrastructure
    - name: position_type
      type: INTEGER
      description: Numeric code classifying the position event type (e.g. trade, adjustment, exercise).
      category: dimension
      filterable: true
      source: PositionEvent.positionType (data/PosData.proto)
      synonyms: ["event type", "pos type"]
    - name: position_id
      type: INTEGER
      description: Identifier for the position this event belongs to within the portfolio.
      category: identifier
      filterable: true
      source: PositionEvent.positionId (data/PosData.proto)
      synonyms: ["pos id"]
    - name: size
      type: INTEGER
      description: Number of lots or contracts in the trade or order.
      category: measure
      typical_aggregation: AVG
      source: kafka infrastructure
      synonyms: ["quantity", "lots", "position size"]
    - name: tv
      type: FLOAT
      description: Theoretical value the VT computed for this instrument at the time of the event.
      category: measure
      typical_aggregation: AVG
      source: kafka infrastructure
      synonyms: ["theo", "theoretical value", "fair value", "machine price", "TV"]
    - name: ectv
      type: FLOAT
      description: Exchange-cleared theoretical value used for settlement calculations.
      category: measure
      typical_aggregation: AVG
      source: kafka infrastructure
    - name: settlement
      type: FLOAT
      description: Settlement price for the instrument.
      category: measure
      typical_aggregation: AVG
      source: kafka infrastructure
    - name: settlement_date
      type: DATE
      description: Date on which settlement occurs for this trade.
      category: time
      source: derived (data-loader)
    - name: pos_currency
      type: INTEGER
      description: Enum appears as an int in composition. From PositionEvent proto.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.currency (data/PosData.proto)
    - name: pos_value_currency
      type: INTEGER
      description: Currency in which the position value is denominated.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.valueCurrency (data/PosData.proto)
    - name: cash_value
      type: FLOAT
      description: Cash value of this trade or position change.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.cashValue (data/PosData.proto)
    - name: mgmt_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the mgmt occurred.
      category: time
      source: PositionEvent.mgmtTimestamp (data/PosData.proto)
    - name: mgmt_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the mgmt timestamp. Combine with mgmt_timestamp for full
        nanosecond-resolution timing.
      category: time
      source: PositionEvent.mgmtTimestamp_ns (data/PosData.proto)
    - name: max_trade_id
      type: INTEGER
      description: Maximum trade ID in the batch, used for ordering and deduplication.
      category: identifier
      filterable: true
      source: PositionEvent.maxTradeId (data/PosData.proto)
    - name: agg_pos_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the agg pos occurred.
      category: time
      source: PositionEvent.aggPosTimestamp (data/PosData.proto)
    - name: agg_pos_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the agg pos timestamp. Combine with agg_pos_timestamp for full
        nanosecond-resolution timing.
      category: time
      source: PositionEvent.aggPosTimestamp_ns (data/PosData.proto)
    - name: agg_pos_date
      type: DATE
      description: Aggregated position date for end-of-day processing.
      category: time
      source: derived (data-loader)
    - name: price
      type: FLOAT
      description: Price of the trade or order.
      category: measure
      typical_aggregation: AVG
      source: kafka infrastructure
      synonyms: ["fill price", "execution price", "trade price"]
    - name: deflection_scale
      type: FLOAT
      description: Scale factor for the deflection adjustment applied to pricing.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.deflectionScale (data/PosData.proto)
    - name: curve_id
      type: INTEGER
      description: Identifier for the volatility/pricing curve used in theoretical calculations.
      category: identifier
      filterable: true
      source: PositionEvent.curveId (data/PosData.proto)
      synonyms: ["vol curve", "vol curve id"]
    - name: carry_id
      type: INTEGER
      description: Identifier for the carry/interest rate curve used in theoretical calculations.
      category: identifier
      filterable: true
      source: PositionEvent.carryId (data/PosData.proto)
      synonyms: ["dividend curve", "carry curve id"]
    - name: revision_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the revision occurred.
      category: time
      source: PositionEvent.revisionTimestamp (data/PosData.proto)
      synonyms: ["amendment time"]
    - name: revision_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the revision timestamp. Combine with revision_timestamp for full
        nanosecond-resolution timing.
      category: time
      source: PositionEvent.revisionTimestamp_ns (data/PosData.proto)
    - name: trade_id
      type: INTEGER
      description: Exchange-assigned trade identifier.
      category: identifier
      filterable: true
      source: PositionEvent.tradeId (data/PosData.proto)
      synonyms: ["fill id", "execution id"]
    - name: company_position
      type: INTEGER
      description: Net company-wide position for this instrument after this event.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.companyPosition (data/PosData.proto)
    - name: traded_size
      type: INTEGER
      description: Number of lots traded in this transaction.
      category: measure
      typical_aggregation: SUM
      source: PositionEvent.tradedSize (data/PosData.proto)
      synonyms: ["fill size", "quantity", "lots", "trade quantity"]
    - name: message_trade_date
      type: DATE
      description: Trade date embedded within the original proto message.
      category: time
      source: derived (data-loader)
    - name: value_date
      type: DATE
      description: Value date for the trade, relevant for settlement calculations.
      category: time
      source: derived (data-loader)
    - name: counterparty
      type: STRING
      description: Counterparty identifier for this trade.
      category: dimension
      filterable: true
      source: kafka infrastructure
      synonyms: ["counter party", "other side", "broker"]
    - name: text
      type: STRING
      description: Free-text field containing additional descriptive information about this event.
      category: dimension
      filterable: true
      source: kafka infrastructure
      synonyms: ["note", "comment", "trade note"]
    - name: revisor
      type: STRING
      description: Identifier of the user or process that last revised this record.
      category: dimension
      filterable: true
      source: kafka infrastructure
      synonyms: ["amender"]
    - name: instrument_hash
      type: STRING
      description: SHA256 of Mako instrument. From PositionEvent proto.
      category: identifier
      filterable: true
      source: PositionEvent.instrumentHash (data/PosData.proto)
      synonyms: ["instrument id", "instrument key"]
    - name: datasource_pid
      type: INTEGER
      description: Data source pid identifier from the data pipeline infrastructure.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.pid (data/PosData.proto)
    - name: datasource_hostname
      type: STRING
      description: Data source hostname identifier from the data pipeline infrastructure.
      category: dimension
      filterable: true
      source: PositionEvent.hostname (data/PosData.proto)
    - name: streamsource_stream_id
      type: INTEGER
      description: Stream source stream id identifier from the data streaming infrastructure.
      category: identifier
      filterable: true
      source: PositionEvent.streamId (data/PosData.proto)
    - name: streamsource_event_id
      type: INTEGER
      description: Stream source event id identifier from the data streaming infrastructure.
      category: identifier
      filterable: true
      source: PositionEvent.eventId (data/PosData.proto)
    - name: streamsource_message_id
      type: INTEGER
      description: Stream source message id identifier from the data streaming infrastructure.
      category: identifier
      filterable: true
      source: PositionEvent.messageId (data/PosData.proto)
    - name: strike
      type: FLOAT
      description: Strike price for options, enriched from the instruments reference table. NULL for non-option
        instruments.
      category: measure
      typical_aggregation: AVG
      source: instrument enrichment (data-loader)
      synonyms: ["exercise price", "strike price", "K"]
    - name: option_type
      type: INTEGER
      description: Option type code (C=Call, P=Put), enriched from the instruments reference table. NULL for non-option
        instruments.
      category: dimension
      filterable: true
      source: instrument enrichment (data-loader)
      synonyms: ["call put", "C/P"]
    - name: option_type_name
      type: STRING
      description: Human-readable option type name (Call/Put), enriched from the instruments reference table.
      category: dimension
      filterable: true
      source: instrument enrichment (data-loader)
      synonyms: ["call put name", "option direction"]
    - name: expiry_timestamp
      type: TIMESTAMP
      description: Expiry timestamp for the instrument, enriched from the instruments reference table.
      category: time
      source: instrument enrichment (data-loader)
      synonyms: ["expiry", "expiration", "maturity date"]
    - name: mako_symbol
      type: STRING
      description: Mako-internal symbol identifier, enriched from the instruments reference table via instrument_hash
        join.
      category: dimension
      filterable: true
      source: instrument enrichment (data-loader)
      synonyms: ["internal symbol"]
    - name: currency
      type: INTEGER
      description: Enum appears as an int in composition. From PositionEvent proto.
      category: dimension
      filterable: true
      source: instrument enrichment (data-loader)
      synonyms: ["ccy", "currency code"]
    - name: inst_type_name
      type: STRING
      description: Human-readable instrument type name (e.g. option, future, stock), enriched from the instruments
        reference table.
      category: dimension
      filterable: true
      source: instrument enrichment (data-loader)
      synonyms: ["instrument type", "product type", "security type"]
    - name: term
      type: STRING
      description: Expiry term/maturity label for the instrument, enriched from the instruments reference table.
      category: dimension
      filterable: true
      source: instrument enrichment (data-loader)
      synonyms: ["tenor", "expiry term", "maturity", "expiry cycle"]

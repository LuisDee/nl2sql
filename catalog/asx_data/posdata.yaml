table:
  name: posdata
  dataset: "{dataset_prefix}asx_data"
  fqn: '{project}.{dataset_prefix}asx_data.posdata'
  layer: data
  description: "Position data snapshots from the PositionEvent proto (PosData.proto). Contains position state records including instrument, portfolio, size, price, and settlement details. The tradedata and clicktrade tables are derived subsets of this data. Partitioned by trade_date."
  partition_field: trade_date
  columns:
    - name: kafka_partition
      type: INTEGER
      description: Kafka partition number from which this record was consumed. Used internally for data pipeline
        tracking and replay.
      category: identifier
      filterable: true
    - name: kafka_offset
      type: INTEGER
      description: Kafka offset of the record within its partition. Used for exactly-once processing guarantees and data
        pipeline replay.
      category: identifier
      filterable: true
    - name: symbol
      type: STRING
      description: Mako symbol identifier for the traded instrument.
      category: dimension
      filterable: true
    - name: portfolio
      type: STRING
      description: Name of the Mako portfolio to which the algo belongs.
      category: dimension
      filterable: true
    - name: trade_date
      type: DATE
      description: Trading session date used as the partition column. Always filter on this field for efficient queries.
      category: time
      filterable: true
    - name: mako_id
      type: STRING
      description: ""
      category: identifier
      filterable: true
    - name: trader_id
      type: STRING
      description: ""
      category: identifier
      filterable: true
    - name: algorithm
      type: STRING
      description: ""
      category: dimension
      filterable: true
    - name: routed_exchange
      type: INTEGER
      description: ""
      category: measure
      typical_aggregation: AVG
    - name: executable_exchange
      type: INTEGER
      description: ""
      category: measure
      typical_aggregation: AVG
    - name: channel
      type: STRING
      description: ""
      category: dimension
      filterable: true
    - name: transaction_properties
      type: INTEGER
      description: A mask of TransactionProperty.
      category: measure
      typical_aggregation: AVG
    - name: tag_book
      type: INTEGER
      description: A mask of TransactionTag.
      category: measure
      typical_aggregation: AVG
    - name: tag_exchange
      type: INTEGER
      description: A mask of TransactionTagExchange.
      category: measure
      typical_aggregation: AVG
    - name: tag_user
      type: INTEGER
      description: A mask of TransactionTagUser.
      category: measure
      typical_aggregation: AVG
    - name: revision
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
    - name: inventory
      type: STRING
      description: ""
      category: dimension
      filterable: true
    - name: account
      type: STRING
      description: ""
      category: dimension
      filterable: true
    - name: fill_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
    - name: user_id
      type: INTEGER
      description: Algo-internal id.
      category: identifier
      filterable: true
    - name: user_order_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
    - name: transaction_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
    - name: order_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
    - name: exchange_transaction_id
      type: STRING
      description: ""
      category: identifier
      filterable: true
    - name: exchange_order_id
      type: STRING
      description: ""
      category: identifier
      filterable: true
    - name: transaction_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the transaction occurred.
      category: time
    - name: transaction_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the transaction timestamp. Combine with transaction_timestamp for
        full nanosecond-resolution timing.
      category: time
    - name: exchange_date
      type: DATE
      description: ""
      category: time
      filterable: true
    - name: exchange_timestamp
      type: TIMESTAMP
      description: Exchange-provided nano-second timestamp of the event.
      category: time
    - name: exchange_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of exchange timestamp. Exchange-provided nano-second timestamp of the
        event.
      category: time
    - name: exchange_info
      type: STRING
      description: ""
      category: dimension
      filterable: true
    - name: exchange_info_bits
      type: INTEGER
      description: A mask of TransactionExchangeInfo.
      category: measure
      typical_aggregation: AVG
    - name: exchange_qualifier
      type: STRING
      description: ""
      category: dimension
      filterable: true
    - name: statistics
      type: STRING
      description: ""
      category: dimension
      filterable: true
    - name: position_type
      type: INTEGER
      description: ""
      category: dimension
      filterable: true
    - name: position_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
    - name: size
      type: INTEGER
      description: ""
      category: measure
      typical_aggregation: AVG
    - name: tv
      type: FLOAT
      description: Theoretical value the VT saw at time of swing/market trade.
      category: measure
      typical_aggregation: AVG
    - name: ectv
      type: FLOAT
      description: ""
      category: measure
      typical_aggregation: AVG
    - name: settlement
      type: FLOAT
      description: ""
      category: measure
      typical_aggregation: AVG
    - name: settlement_date
      type: DATE
      description: ""
      category: time
    - name: pos_currency
      type: INTEGER
      description: Enum appears as an int in composition.
      category: measure
      typical_aggregation: AVG
    - name: pos_value_currency
      type: INTEGER
      description: ""
      category: measure
      typical_aggregation: AVG
    - name: cash_value
      type: FLOAT
      description: ""
      category: measure
      typical_aggregation: AVG
    - name: mgmt_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the mgmt occurred.
      category: time
    - name: mgmt_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the mgmt timestamp. Combine with mgmt_timestamp for full
        nanosecond-resolution timing.
      category: time
    - name: max_trade_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
    - name: agg_pos_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the agg pos occurred.
      category: time
    - name: agg_pos_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the agg pos timestamp. Combine with agg_pos_timestamp for full
        nanosecond-resolution timing.
      category: time
    - name: agg_pos_date
      type: DATE
      description: ""
      category: time
    - name: price
      type: FLOAT
      description: ""
      category: measure
      typical_aggregation: AVG
    - name: deflection_scale
      type: FLOAT
      description: ""
      category: measure
      typical_aggregation: AVG
    - name: curve_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
    - name: carry_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
    - name: revision_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the revision occurred.
      category: time
    - name: revision_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the revision timestamp. Combine with revision_timestamp for full
        nanosecond-resolution timing.
      category: time
    - name: trade_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
    - name: company_position
      type: INTEGER
      description: ""
      category: measure
      typical_aggregation: AVG
    - name: traded_size
      type: INTEGER
      description: ""
      category: measure
      typical_aggregation: SUM
    - name: message_trade_date
      type: DATE
      description: Trade date embedded within the original proto message.
      category: time
    - name: value_date
      type: DATE
      description: ""
      category: time
    - name: counterparty
      type: STRING
      description: ""
      category: dimension
      filterable: true
    - name: text
      type: STRING
      description: ""
      category: dimension
      filterable: true
    - name: revisor
      type: STRING
      description: ""
      category: dimension
      filterable: true
    - name: instrument_hash
      type: STRING
      description: Unique SHA256 hash identifier for the instrument, deterministically computed from the instrument
        defining attributes. Used as the primary join key across all data and KPI tables.
      category: identifier
      filterable: true
    - name: strike
      type: FLOAT
      description: Strike price for options, enriched from the instruments reference table. NULL for non-option
        instruments.
      category: measure
      typical_aggregation: AVG
    - name: option_type
      type: INTEGER
      description: Option type code (C=Call, P=Put), enriched from the instruments reference table. NULL for non-option
        instruments.
      category: dimension
      filterable: true
    - name: option_type_name
      type: STRING
      description: Human-readable option type name (Call/Put), enriched from the instruments reference table.
      category: dimension
      filterable: true
    - name: expiry_timestamp
      type: TIMESTAMP
      description: Expiry timestamp for the instrument, enriched from the instruments reference table.
      category: time
    - name: mako_symbol
      type: STRING
      description: Mako-internal symbol identifier, enriched from the instruments reference table via instrument_hash
        join.
      category: dimension
      filterable: true
    - name: currency
      type: INTEGER
      description: Enum appears as an int in composition.
      category: dimension
      filterable: true
    - name: term
      type: STRING
      description: Expiry term/maturity label for the instrument, enriched from the instruments reference table.
      category: dimension
      filterable: true
    - name: inst_type_name
      type: STRING
      description: Human-readable instrument type name (e.g. option, future, stock), enriched from the instruments
        reference table.
      category: dimension
      filterable: true
    - name: streamsource_stream_id
      type: INTEGER
      description: Stream source stream id identifier from the data streaming infrastructure.
      category: identifier
      filterable: true
    - name: streamsource_event_id
      type: INTEGER
      description: Stream source event id identifier from the data streaming infrastructure.
      category: identifier
      filterable: true
    - name: streamsource_message_id
      type: INTEGER
      description: Stream source message id identifier from the data streaming infrastructure.
      category: identifier
      filterable: true
    - name: datasource_pid
      type: INTEGER
      description: Data source pid identifier from the data pipeline infrastructure.
      category: measure
      typical_aggregation: AVG
    - name: datasource_hostname
      type: STRING
      description: Data source hostname identifier from the data pipeline infrastructure.
      category: dimension
      filterable: true

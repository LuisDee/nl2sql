# Cross-Cutting Concerns

> This file is **append-only**. New versions are added below existing ones.
> Never modify a published version — add a new version section instead.
> Each version is tagged to the wave where it was introduced.

---

## v1 — Initial (Wave 1)

<!-- Generated by /architect-decompose from cross-cutting-catalog.md evaluation. -->

### Structured Logging
- Uses **structlog** to produce JSON output, including trace ID, request ID, and log level.
- Logs include inputs, outputs, and any internal reasoning context.
- Applies to: ALL services and tool executions.
- Source: Architecture research (Accepted).

### Configuration
- Uses **Pydantic BaseSettings** to read all configuration from environment variables.
- Secrets (database credentials, API keys) must be loaded from Google Secret Manager or secure environment variables, never committed.
- Applies to: ALL services.
- Source: Architecture research (Accepted).

### Timeouts
- All external calls (BigQuery execution, Vertex AI generation) must enforce explicit timeouts.
- Default timeouts: 30s for BigQuery, 10s for Vertex AI.
- Applies to: Execution Service, Generation Service.
- Source: Architecture research (Accepted).

### Input Validation
- All tool inputs (natural language queries, SQL snippets) must be validated via **Pydantic models**.
- Validation failures should return user-friendly error messages, not stack traces.
- Applies to: ALL public agent tools.
- Source: Architecture research (Accepted).

### Error Handling
- Standardized error mapping: `BigQueryError` -> `AgentExecutionError` with a clear user message.
- Exceptions caught at the tool boundary and returned as structured error objects.
- Applies to: ALL services.
- Source: Architecture research (Accepted).

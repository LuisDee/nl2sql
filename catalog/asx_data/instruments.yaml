table:
  name: instruments
  dataset: "{dataset_prefix}asx_data"
  fqn: '{project}.{dataset_prefix}asx_data.instruments'
  layer: data
  description: "Master instrument reference data containing symbol, strike, expiry, option type, contract size, currency, and instrument hash. Used as the lookup table for instrument enrichment joins across all other data tables. Partitioned by trade_date."
  partition_field: trade_date
  columns:
    - name: symbol
      type: STRING
      description: Mako symbol identifier for the traded instrument.
      category: dimension
      filterable: true
    - name: portfolio
      type: STRING
      description: Name of the Mako portfolio to which the algo belongs.
      category: dimension
      filterable: true
    - name: trade_date
      type: DATE
      description: Trading session date used as the partition column. Always filter on this field for efficient queries.
      category: time
      filterable: true
    - name: partition_timestamp_local
      type: TIMESTAMP
      description: Local-timezone timestamp of the data partition. Used for partition-level data management in the
        pipeline.
      category: time
    - name: parent_instrument_hash
      type: STRING
      description: SHA256 hash identifier for the parent instrument.
      category: identifier
      filterable: true
    - name: parent_no_legs
      type: INTEGER
      description: Parent instrument no legs from the instrument definition.
      category: measure
      typical_aggregation: AVG
    - name: parent_settle_type
      type: INTEGER
      description: Parent instrument settle type from the instrument definition.
      category: dimension
      filterable: true
    - name: parent_settle_type_name
      type: STRING
      description: Human-readable name for the parent settle type enum value.
      category: dimension
      filterable: true
    - name: parent_composition
      type: STRING
      description: Parent instrument composition from the instrument definition.
      category: dimension
      filterable: true
    - name: parent_feed_code
      type: STRING
      description: Parent instrument feed code from the instrument definition.
      category: dimension
      filterable: true
    - name: parent_exchange_native
      type: STRING
      description: Parent instrument exchange native from the instrument definition.
      category: dimension
      filterable: true
    - name: parent_mako_symbol
      type: STRING
      description: Parent instrument mako symbol from the instrument definition.
      category: dimension
      filterable: true
    - name: parent_isin
      type: STRING
      description: Parent instrument isin from the instrument definition.
      category: dimension
      filterable: true
    - name: parent_sedol
      type: STRING
      description: Parent instrument sedol from the instrument definition.
      category: dimension
      filterable: true
    - name: parent_cusip
      type: STRING
      description: Parent instrument cusip from the instrument definition.
      category: dimension
      filterable: true
    - name: parent_bloomberg
      type: STRING
      description: Parent instrument bloomberg from the instrument definition.
      category: dimension
      filterable: true
    - name: parent_reuters
      type: STRING
      description: Parent instrument reuters from the instrument definition.
      category: dimension
      filterable: true
    - name: parent_raw_proto
      type: BYTES
      description: Parent instrument raw proto from the instrument definition.
      category: dimension
      filterable: true
    - name: parent_is_combo
      type: BOOLEAN
      description: Parent instrument is combo from the instrument definition.
      category: dimension
      filterable: true
    - name: parent_combo_type
      type: INTEGER
      description: Parent instrument combo type from the instrument definition.
      category: dimension
      filterable: true
    - name: parent_combo_type_name
      type: STRING
      description: Human-readable name for the parent combo type enum value.
      category: dimension
      filterable: true
    - name: parent_listed
      type: INTEGER
      description: Parent instrument listed from the instrument definition.
      category: measure
      typical_aggregation: AVG
    - name: parent_listed_name
      type: STRING
      description: Human-readable name for the parent listed enum value.
      category: dimension
      filterable: true
    - name: parent_pos_exchange
      type: INTEGER
      description: Parent instrument pos exchange from the instrument definition.
      category: measure
      typical_aggregation: AVG
    - name: parent_currency
      type: INTEGER
      description: Parent instrument currency from the instrument definition.
      category: measure
      typical_aggregation: AVG
    - name: parent_currency_name
      type: STRING
      description: Human-readable name for the parent currency enum value.
      category: dimension
      filterable: true
    - name: parent_contract_size
      type: FLOAT
      description: Parent instrument contract size from the instrument definition.
      category: measure
      typical_aggregation: SUM
    - name: leg_index
      type: INTEGER
      description: Combo leg index.
      category: measure
      typical_aggregation: AVG
    - name: ratio
      type: FLOAT
      description: Leg ratio within a combo instrument, indicating relative weighting.
      category: measure
      typical_aggregation: AVG
    - name: instrument_hash
      type: STRING
      description: Unique SHA256 hash identifier for the instrument, deterministically computed from the instrument
        defining attributes. Used as the primary join key across all data and KPI tables.
      category: identifier
      filterable: true
    - name: underlying_hash
      type: STRING
      description: SHA256 hash identifier for the underlying.
      category: identifier
      filterable: true
    - name: pricing_count
      type: INTEGER
      description: Number of pricing inputs available for this instrument.
      category: measure
      typical_aggregation: AVG
    - name: inst_type
      type: INTEGER
      description: Numeric instrument type code.
      category: dimension
      filterable: true
    - name: inst_type_name
      type: STRING
      description: Human-readable instrument type name (e.g. option, future, stock), enriched from the instruments
        reference table.
      category: dimension
      filterable: true
    - name: listed
      type: INTEGER
      description: Enum appears as a char in composition.
      category: measure
      typical_aggregation: AVG
    - name: listed_name
      type: STRING
      description: Enum appears as a char in composition (human-readable enum name).
      category: dimension
      filterable: true
    - name: pos_exch
      type: INTEGER
      description: Enum appears as an int in composition.
      category: measure
      typical_aggregation: AVG
    - name: currency
      type: INTEGER
      description: Enum appears as an int in composition.
      category: dimension
      filterable: true
    - name: currency_name
      type: STRING
      description: Enum appears as an int in composition (human-readable enum name).
      category: dimension
      filterable: true
    - name: revision
      type: INTEGER
      description: Revision number tracking modifications to this record.
      category: identifier
      filterable: true
    - name: contract_size
      type: FLOAT
      description: Number of units per contract lot. Streamed from TradableInstrument.contractSize proto field.
      category: measure
      typical_aggregation: AVG
    - name: term
      type: STRING
      description: Expiry term/maturity label for the instrument, enriched from the instruments reference table.
      category: dimension
      filterable: true
    - name: expiry_timestamp
      type: TIMESTAMP
      description: Expiry timestamp for the instrument, enriched from the instruments reference table.
      category: time
    - name: expiry_timezone
      type: STRING
      description: Timezone of the instrument expiry.
      category: dimension
      filterable: true
    - name: issue_date
      type: TIMESTAMP
      description: Issue date for bonds or newly listed instruments.
      category: time
    - name: bond_type
      type: INTEGER
      description: Enum appears as a char in composition.
      category: dimension
      filterable: true
    - name: bond_type_name
      type: STRING
      description: Enum appears as a char in composition (human-readable enum name).
      category: dimension
      filterable: true
    - name: day_count_type
      type: INTEGER
      description: Enum appears as a char in composition.
      category: dimension
      filterable: true
    - name: day_count_type_name
      type: STRING
      description: Enum appears as a char in composition (human-readable enum name).
      category: dimension
      filterable: true
    - name: coupon_type
      type: INTEGER
      description: Enum appears as a char in composition.
      category: dimension
      filterable: true
    - name: coupon_type_name
      type: STRING
      description: Enum appears as a char in composition (human-readable enum name).
      category: dimension
      filterable: true
    - name: coupon_freq_type
      type: INTEGER
      description: Enum appears as an int in composition.
      category: dimension
      filterable: true
    - name: coupon
      type: FLOAT
      description: Coupon rate for bond instruments.
      category: measure
      typical_aggregation: AVG
    - name: has_underlying
      type: BOOLEAN
      description: Boolean indicating whether this instrument has an underlying reference.
      category: dimension
      filterable: true
    - name: stock_type
      type: INTEGER
      description: Enum appears as a char in composition.
      category: dimension
      filterable: true
    - name: stock_type_name
      type: STRING
      description: Enum appears as a char in composition (human-readable enum name).
      category: dimension
      filterable: true
    - name: payment_type
      type: INTEGER
      description: Payment type for the instrument (physical, cash settlement, etc.).
      category: dimension
      filterable: true
    - name: payment_type_name
      type: STRING
      description: Human-readable name for the payment type enum value.
      category: dimension
      filterable: true
    - name: cash_type
      type: INTEGER
      description: Enum appears as a char in composition.
      category: dimension
      filterable: true
    - name: cash_type_name
      type: STRING
      description: Enum appears as a char in composition (human-readable enum name).
      category: dimension
      filterable: true
    - name: option_type
      type: INTEGER
      description: Option type code (C=Call, P=Put), enriched from the instruments reference table. NULL for non-option
        instruments.
      category: dimension
      filterable: true
    - name: option_type_name
      type: STRING
      description: Human-readable option type name (Call/Put), enriched from the instruments reference table.
      category: dimension
      filterable: true
    - name: exercise_type
      type: INTEGER
      description: Exercise type for options (European, American, etc.).
      category: dimension
      filterable: true
    - name: exercise_type_name
      type: STRING
      description: Human-readable name for the exercise type enum value.
      category: dimension
      filterable: true
    - name: pos_currency
      type: INTEGER
      description: Enum appears as an int in composition.
      category: measure
      typical_aggregation: AVG
    - name: pos_currency_name
      type: STRING
      description: Enum appears as an int in composition (human-readable enum name).
      category: dimension
      filterable: true
    - name: comm_type
      type: INTEGER
      description: Enum appears as an int in composition.
      category: dimension
      filterable: true
    - name: strike
      type: FLOAT
      description: Strike price for options, enriched from the instruments reference table. NULL for non-option
        instruments.
      category: measure
      typical_aggregation: AVG
    - name: underlying_inst_type
      type: INTEGER
      description: Underlying instrument inst type, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_inst_type_name
      type: STRING
      description: Human-readable name for the underlying inst type enum value.
      category: dimension
      filterable: true
    - name: underlying_listed
      type: INTEGER
      description: Underlying instrument listed, mirrored from the parent instrument definition.
      category: measure
      typical_aggregation: AVG
    - name: underlying_listed_name
      type: STRING
      description: Human-readable name for the underlying listed enum value.
      category: dimension
      filterable: true
    - name: underlying_pos_exch
      type: INTEGER
      description: Underlying instrument pos exch, mirrored from the parent instrument definition.
      category: measure
      typical_aggregation: AVG
    - name: underlying_currency
      type: INTEGER
      description: Underlying instrument currency, mirrored from the parent instrument definition.
      category: measure
      typical_aggregation: AVG
    - name: underlying_currency_name
      type: STRING
      description: Human-readable name for the underlying currency enum value.
      category: dimension
      filterable: true
    - name: underlying_revision
      type: INTEGER
      description: Underlying instrument revision, mirrored from the parent instrument definition.
      category: measure
      typical_aggregation: AVG
    - name: underlying_contract_size
      type: FLOAT
      description: Underlying instrument contract size, mirrored from the parent instrument definition.
      category: measure
      typical_aggregation: SUM
    - name: underlying_term
      type: STRING
      description: Underlying instrument term, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_expiry_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the underlying expiry occurred.
      category: time
    - name: underlying_expiry_timezone
      type: STRING
      description: Underlying instrument expiry timezone, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_issue_date
      type: TIMESTAMP
      description: Underlying instrument issue date, mirrored from the parent instrument definition.
      category: time
    - name: underlying_bond_type
      type: INTEGER
      description: Underlying instrument bond type, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_bond_type_name
      type: STRING
      description: Human-readable name for the underlying bond type enum value.
      category: dimension
      filterable: true
    - name: underlying_day_count_type
      type: INTEGER
      description: Underlying instrument day count type, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_day_count_type_name
      type: STRING
      description: Human-readable name for the underlying day count type enum value.
      category: dimension
      filterable: true
    - name: underlying_coupon_type
      type: INTEGER
      description: Underlying instrument coupon type, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_coupon_type_name
      type: STRING
      description: Human-readable name for the underlying coupon type enum value.
      category: dimension
      filterable: true
    - name: underlying_coupon_freq_type
      type: INTEGER
      description: Underlying instrument coupon freq type, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_coupon
      type: FLOAT
      description: Underlying instrument coupon, mirrored from the parent instrument definition.
      category: measure
      typical_aggregation: AVG
    - name: underlying_has_underlying
      type: BOOLEAN
      description: Underlying instrument has underlying, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_stock_type
      type: INTEGER
      description: Underlying instrument stock type, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_stock_type_name
      type: STRING
      description: Human-readable name for the underlying stock type enum value.
      category: dimension
      filterable: true
    - name: underlying_payment_type
      type: INTEGER
      description: Underlying instrument payment type, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_payment_type_name
      type: STRING
      description: Human-readable name for the underlying payment type enum value.
      category: dimension
      filterable: true
    - name: underlying_cash_type
      type: INTEGER
      description: Underlying instrument cash type, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_cash_type_name
      type: STRING
      description: Human-readable name for the underlying cash type enum value.
      category: dimension
      filterable: true
    - name: underlying_option_type
      type: INTEGER
      description: Underlying instrument option type, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_option_type_name
      type: STRING
      description: Human-readable name for the underlying option type enum value.
      category: dimension
      filterable: true
    - name: underlying_exercise_type
      type: INTEGER
      description: Underlying instrument exercise type, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_exercise_type_name
      type: STRING
      description: Human-readable name for the underlying exercise type enum value.
      category: dimension
      filterable: true
    - name: underlying_pos_currency
      type: INTEGER
      description: Underlying instrument pos currency, mirrored from the parent instrument definition.
      category: measure
      typical_aggregation: AVG
    - name: underlying_pos_currency_name
      type: STRING
      description: Human-readable name for the underlying pos currency enum value.
      category: dimension
      filterable: true
    - name: underlying_comm_type
      type: INTEGER
      description: Underlying instrument comm type, mirrored from the parent instrument definition.
      category: dimension
      filterable: true
    - name: underlying_strike
      type: FLOAT
      description: Underlying instrument strike, mirrored from the parent instrument definition.
      category: measure
      typical_aggregation: AVG

table:
  name: tradedata
  dataset: "{dataset_prefix}ice_data"
  fqn: '{project}.{dataset_prefix}ice_data.tradedata'
  layer: data
  description: "Raw trade execution data from the PositionEvent proto (PosData.proto). Contains all position and trade events including algorithm name, position type, and transaction details. This is the superset table from which the clicktrade KPI table is derived by filtering on algorithm and position type. Partitioned by trade_date."
  partition_field: trade_date
  columns:
    - name: kafka_partition
      type: INTEGER
      description: Kafka partition number from which this record was consumed. Used internally for data pipeline
        tracking and replay.
      category: identifier
      filterable: true
      source: kafka infrastructure
    - name: kafka_offset
      type: INTEGER
      description: Kafka offset of the record within its partition. Used for exactly-once processing guarantees and data
        pipeline replay.
      category: identifier
      filterable: true
      source: kafka infrastructure
    - name: symbol
      type: STRING
      description: Mako symbol identifier for the traded instrument.
      category: dimension
      filterable: true
      source: kafka infrastructure
    - name: portfolio
      type: STRING
      description: Name of the Mako portfolio to which the trading algorithm belongs.
      category: dimension
      filterable: true
      source: kafka infrastructure
    - name: trade_date
      type: DATE
      description: Trading session date used as the partition column. Always filter on this field for efficient queries.
      category: time
      filterable: true
      source: kafka infrastructure
    - name: mako_id
      type: STRING
      description: ""
      category: identifier
      filterable: true
      source: PositionEvent.makoId (data/PosData.proto)
    - name: trader_id
      type: STRING
      description: ""
      category: identifier
      filterable: true
      source: PositionEvent.traderId (data/PosData.proto)
    - name: algorithm
      type: STRING
      description: ""
      category: dimension
      filterable: true
      source: kafka infrastructure
    - name: routed_exchange
      type: INTEGER
      description: ""
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.routedExchange (data/PosData.proto)
    - name: executable_exchange
      type: INTEGER
      description: ""
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.executableExchange (data/PosData.proto)
    - name: channel
      type: STRING
      description: ""
      category: dimension
      filterable: true
      source: kafka infrastructure
    - name: transaction_properties
      type: INTEGER
      description: A mask of TransactionProperty. From PositionEvent proto.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.transactionProperties (data/PosData.proto)
    - name: tag_book
      type: INTEGER
      description: A mask of TransactionTag. From PositionEvent proto.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.tagBook (data/PosData.proto)
    - name: tag_exchange
      type: INTEGER
      description: A mask of TransactionTagExchange. From PositionEvent proto.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.tagExchange (data/PosData.proto)
    - name: tag_user
      type: INTEGER
      description: A mask of TransactionTagUser. From PositionEvent proto.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.tagUser (data/PosData.proto)
    - name: revision
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
      source: kafka infrastructure
    - name: inventory
      type: STRING
      description: ""
      category: dimension
      filterable: true
      source: kafka infrastructure
    - name: account
      type: STRING
      description: ""
      category: dimension
      filterable: true
      source: kafka infrastructure
    - name: fill_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
      source: PositionEvent.fillId (data/PosData.proto)
    - name: user_id
      type: INTEGER
      description: Algo-internal id. From PositionEvent proto.
      category: identifier
      filterable: true
      source: PositionEvent.userId (data/PosData.proto)
    - name: user_order_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
      source: PositionEvent.userOrderId (data/PosData.proto)
    - name: transaction_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
      source: PositionEvent.transactionId (data/PosData.proto)
    - name: order_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
      source: PositionEvent.orderId (data/PosData.proto)
    - name: exchange_transaction_id
      type: STRING
      description: ""
      category: identifier
      filterable: true
      source: PositionEvent.exchangeTransactionId (data/PosData.proto)
    - name: exchange_order_id
      type: STRING
      description: ""
      category: identifier
      filterable: true
      source: PositionEvent.exchangeOrderId (data/PosData.proto)
    - name: transaction_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the transaction occurred.
      category: time
      source: PositionEvent.transactionTimestamp (data/PosData.proto)
    - name: transaction_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the transaction timestamp. Combine with transaction_timestamp for
        full nanosecond-resolution timing.
      category: time
      source: PositionEvent.transactionTimestamp_ns (data/PosData.proto)
    - name: exchange_date
      type: DATE
      description: ""
      category: time
      filterable: true
      source: derived (data-loader)
    - name: exchange_timestamp
      type: TIMESTAMP
      description: Exchange-provided nano-second timestamp of the event. From PositionEvent proto.
      category: time
      source: PositionEvent.exchangeTimestamp (data/PosData.proto)
    - name: exchange_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of exchange timestamp. Exchange-provided nano-second timestamp of the
        event. From PositionEvent proto.
      category: time
      source: PositionEvent.exchangeTimestamp_ns (data/PosData.proto)
    - name: exchange_info
      type: STRING
      description: ""
      category: dimension
      filterable: true
      source: PositionEvent.exchangeInfo (data/PosData.proto)
    - name: exchange_info_bits
      type: INTEGER
      description: A mask of TransactionExchangeInfo. From PositionEvent proto.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.exchangeInfoBits (data/PosData.proto)
    - name: exchange_qualifier
      type: STRING
      description: ""
      category: dimension
      filterable: true
      source: PositionEvent.exchangeQualifier (data/PosData.proto)
    - name: statistics
      type: STRING
      description: ""
      category: dimension
      filterable: true
      source: kafka infrastructure
    - name: position_type
      type: INTEGER
      description: ""
      category: dimension
      filterable: true
      source: PositionEvent.positionType (data/PosData.proto)
    - name: position_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
      source: PositionEvent.positionId (data/PosData.proto)
    - name: size
      type: INTEGER
      description: ""
      category: measure
      typical_aggregation: AVG
      source: kafka infrastructure
    - name: tv
      type: FLOAT
      description: Theoretical value the VT computed for this instrument at the time of the event.
      category: measure
      typical_aggregation: AVG
      source: kafka infrastructure
    - name: ectv
      type: FLOAT
      description: ""
      category: measure
      typical_aggregation: AVG
      source: kafka infrastructure
    - name: settlement
      type: FLOAT
      description: ""
      category: measure
      typical_aggregation: AVG
      source: kafka infrastructure
    - name: settlement_date
      type: DATE
      description: ""
      category: time
      source: derived (data-loader)
    - name: pos_currency
      type: INTEGER
      description: Enum appears as an int in composition. From PositionEvent proto.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.currency (data/PosData.proto)
    - name: pos_value_currency
      type: INTEGER
      description: ""
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.valueCurrency (data/PosData.proto)
    - name: cash_value
      type: FLOAT
      description: ""
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.cashValue (data/PosData.proto)
    - name: mgmt_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the mgmt occurred.
      category: time
      source: PositionEvent.mgmtTimestamp (data/PosData.proto)
    - name: mgmt_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the mgmt timestamp. Combine with mgmt_timestamp for full
        nanosecond-resolution timing.
      category: time
      source: PositionEvent.mgmtTimestamp_ns (data/PosData.proto)
    - name: max_trade_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
      source: PositionEvent.maxTradeId (data/PosData.proto)
    - name: agg_pos_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the agg pos occurred.
      category: time
      source: PositionEvent.aggPosTimestamp (data/PosData.proto)
    - name: agg_pos_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the agg pos timestamp. Combine with agg_pos_timestamp for full
        nanosecond-resolution timing.
      category: time
      source: PositionEvent.aggPosTimestamp_ns (data/PosData.proto)
    - name: agg_pos_date
      type: DATE
      description: ""
      category: time
      source: derived (data-loader)
    - name: price
      type: FLOAT
      description: ""
      category: measure
      typical_aggregation: AVG
      source: kafka infrastructure
    - name: deflection_scale
      type: FLOAT
      description: ""
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.deflectionScale (data/PosData.proto)
    - name: curve_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
      source: PositionEvent.curveId (data/PosData.proto)
    - name: carry_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
      source: PositionEvent.carryId (data/PosData.proto)
    - name: revision_timestamp
      type: TIMESTAMP
      description: Timestamp recording when the revision occurred.
      category: time
      source: PositionEvent.revisionTimestamp (data/PosData.proto)
    - name: revision_timestamp_ns
      type: INTEGER
      description: Nanosecond-precision component of the revision timestamp. Combine with revision_timestamp for full
        nanosecond-resolution timing.
      category: time
      source: PositionEvent.revisionTimestamp_ns (data/PosData.proto)
    - name: trade_id
      type: INTEGER
      description: ""
      category: identifier
      filterable: true
      source: PositionEvent.tradeId (data/PosData.proto)
    - name: company_position
      type: INTEGER
      description: ""
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.companyPosition (data/PosData.proto)
    - name: traded_size
      type: INTEGER
      description: ""
      category: measure
      typical_aggregation: SUM
      source: PositionEvent.tradedSize (data/PosData.proto)
    - name: message_trade_date
      type: DATE
      description: Trade date embedded within the original proto message.
      category: time
      source: derived (data-loader)
    - name: value_date
      type: DATE
      description: ""
      category: time
      source: derived (data-loader)
    - name: counterparty
      type: STRING
      description: ""
      category: dimension
      filterable: true
      source: kafka infrastructure
    - name: text
      type: STRING
      description: ""
      category: dimension
      filterable: true
      source: kafka infrastructure
    - name: revisor
      type: STRING
      description: ""
      category: dimension
      filterable: true
      source: kafka infrastructure
    - name: instrument_hash
      type: STRING
      description: SHA256 of Mako instrument. From PositionEvent proto.
      category: identifier
      filterable: true
      source: PositionEvent.instrumentHash (data/PosData.proto)
    - name: strike
      type: FLOAT
      description: Strike price for options, enriched from the instruments reference table. NULL for non-option
        instruments.
      category: measure
      typical_aggregation: AVG
      source: instrument enrichment (data-loader)
    - name: option_type
      type: INTEGER
      description: Option type code (C=Call, P=Put), enriched from the instruments reference table. NULL for non-option
        instruments.
      category: dimension
      filterable: true
      source: instrument enrichment (data-loader)
    - name: option_type_name
      type: STRING
      description: Human-readable option type name (Call/Put), enriched from the instruments reference table.
      category: dimension
      filterable: true
      source: instrument enrichment (data-loader)
    - name: expiry_timestamp
      type: TIMESTAMP
      description: Expiry timestamp for the instrument, enriched from the instruments reference table.
      category: time
      source: instrument enrichment (data-loader)
    - name: mako_symbol
      type: STRING
      description: Mako-internal symbol identifier, enriched from the instruments reference table via instrument_hash
        join.
      category: dimension
      filterable: true
      source: instrument enrichment (data-loader)
    - name: currency
      type: INTEGER
      description: Enum appears as an int in composition. From PositionEvent proto.
      category: dimension
      filterable: true
      source: instrument enrichment (data-loader)
    - name: term
      type: STRING
      description: Expiry term/maturity label for the instrument, enriched from the instruments reference table.
      category: dimension
      filterable: true
      source: instrument enrichment (data-loader)
    - name: inst_type_name
      type: STRING
      description: Human-readable instrument type name (e.g. option, future, stock), enriched from the instruments
        reference table.
      category: dimension
      filterable: true
      source: instrument enrichment (data-loader)
    - name: streamsource_stream_id
      type: INTEGER
      description: Stream source stream id identifier from the data streaming infrastructure.
      category: identifier
      filterable: true
      source: PositionEvent.streamId (data/PosData.proto)
    - name: streamsource_event_id
      type: INTEGER
      description: Stream source event id identifier from the data streaming infrastructure.
      category: identifier
      filterable: true
      source: PositionEvent.eventId (data/PosData.proto)
    - name: streamsource_message_id
      type: INTEGER
      description: Stream source message id identifier from the data streaming infrastructure.
      category: identifier
      filterable: true
      source: PositionEvent.messageId (data/PosData.proto)
    - name: datasource_pid
      type: INTEGER
      description: Data source pid identifier from the data pipeline infrastructure.
      category: measure
      typical_aggregation: AVG
      source: PositionEvent.pid (data/PosData.proto)
    - name: datasource_hostname
      type: STRING
      description: Data source hostname identifier from the data pipeline infrastructure.
      category: dimension
      filterable: true
      source: PositionEvent.hostname (data/PosData.proto)

# Implementation Plan: Core NL2SQL Pipeline\n\n## Phase 1: Project Setup\n- [ ] Task: Initialize Python project structure (poetry or pip) with virtual environment.\n- [ ] Task: Install core dependencies (`google-cloud-aiplatform`, `google-cloud-bigquery`, `pydantic`).\n- [ ] Task: Configure Google Cloud authentication and project settings.\n- [ ] Task: Conductor - User Manual Verification 'Project Setup' (Protocol in workflow.md)\n\n## Phase 2: Metadata Catalog\n- [ ] Task: Define YAML schema for table and column metadata.\n- [ ] Task: Implement `MetadataCatalog` class to load and parse YAML files.\n    - [ ] Write Tests for `MetadataCatalog` loading.\n    - [ ] Implement `MetadataCatalog` methods.\n- [ ] Task: Conductor - User Manual Verification 'Metadata Catalog' (Protocol in workflow.md)\n\n## Phase 3: Semantic Search Integration\n- [ ] Task: Implement `EmbeddingService` class using Vertex AI Embeddings.\n    - [ ] Write Tests for embedding generation.\n    - [ ] Implement `EmbeddingService` methods.\n- [ ] Task: Integrate semantic search logic to retrieve relevant tables for a query.\n    - [ ] Write Tests for semantic search logic.\n    - [ ] Implement search integration.\n- [ ] Task: Conductor - User Manual Verification 'Semantic Search' (Protocol in workflow.md)\n\n## Phase 4: SQL Generation Logic\n- [ ] Task: Define prompt templates for NL2SQL generation with schema context.\n- [ ] Task: Implement `SQLGenerator` class using Vertex AI Gemini Pro.\n    - [ ] Write Tests for prompt construction.\n    - [ ] Implement `SQLGenerator` methods.\n- [ ] Task: Conductor - User Manual Verification 'SQL Generation' (Protocol in workflow.md)\n\n## Phase 5: Validation and Dry-Run\n- [ ] Task: Implement `SQLValidator` class for dry-run validation against BigQuery.\n    - [ ] Write Tests for validation logic (mocking BigQuery response).\n    - [ ] Implement `SQLValidator` methods.\n- [ ] Task: Conductor - User Manual Verification 'Validation' (Protocol in workflow.md)
